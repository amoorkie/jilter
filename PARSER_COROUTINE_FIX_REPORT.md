# üîß –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ coroutine –≤ –ø–∞—Ä—Å–µ—Ä–µ

## ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ:**

### **1. –ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå **–û—à–∏–±–∫–∞:** `ERROR: root:..... ........ habr: object of type 'coroutine' has no len()`
- ‚ùå **–ü—Ä–∏—á–∏–Ω–∞:** –í `unified_parser.py` –≤—ã–∑—ã–≤–∞–ª–∏—Å—å async —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ `await`
- ‚ùå **–ò—Å—Ç–æ—á–Ω–∏–∫:** `habr_parser.py` –∏–º–µ–µ—Ç async –º–µ—Ç–æ–¥ `parse_vacancies`, –Ω–æ –≤—ã–∑—ã–≤–∞–ª—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

### **2. –†–µ—à–µ–Ω–∏–µ:**

#### **üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ `parsers/unified_parser.py`:**

**1. –û–±–Ω–æ–≤–∏–ª–∏ `parse_source` –º–µ—Ç–æ–¥:**
```python
# –ë—ã–ª–æ:
def parse_source(self, source_name: str, parser, query: str, pages: int, extract_details: bool):

# –°—Ç–∞–ª–æ:
async def parse_source(self, source_name: str, parser, query: str, pages: int, extract_details: bool):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–µ—Ç–æ–¥ async
    if hasattr(parser.parse_vacancies, '__code__') and 'async' in str(parser.parse_vacancies.__code__.co_flags):
        vacancies = await parser.parse_vacancies(...)
    else:
        vacancies = parser.parse_vacancies(...)
```

**2. –û–±–Ω–æ–≤–∏–ª–∏ `parse_all_sources` –º–µ—Ç–æ–¥:**
```python
# –ë—ã–ª–æ:
def parse_all_sources(self, ...):

# –°—Ç–∞–ª–æ:
async def parse_all_sources(self, ...):
    # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å asyncio
    import asyncio
    tasks = []
    
    for source_name in sources:
        if source_name in self.parsers:
            parser = self.parsers[source_name]
            task = self.parse_source(...)
            tasks.append((source_name, task))
    
    # –í—ã–ø–æ–ª–Ω—è–µ–º –≤—Å–µ –∑–∞–¥–∞—á–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    for source_name, task in tasks:
        vacancies = await task
        results[source_name] = vacancies
```

**3. –û–±–Ω–æ–≤–∏–ª–∏ main —Ñ—É–Ω–∫—Ü–∏—é:**
```python
# –ë—ã–ª–æ:
results = unified_parser.parse_all_sources(...)

# –°—Ç–∞–ª–æ:
import asyncio
results = asyncio.run(unified_parser.parse_all_sources(...))
```

### **3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**

#### **üéØ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ **Async/await –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ async –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è asyncio –≤–º–µ—Å—Ç–æ ThreadPoolExecutor
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ async, —Ç–∞–∫ –∏ sync –ø–∞—Ä—Å–µ—Ä–æ–≤
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - coroutine –æ–±—ä–µ–∫—Ç—ã —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ await'—è—Ç—Å—è

#### **üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä—Å–µ—Ä—ã:**
- ‚úÖ **HH.ru** - sync –ø–∞—Ä—Å–µ—Ä (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- ‚úÖ **HireHi** - sync –ø–∞—Ä—Å–µ—Ä (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)  
- ‚úÖ **Habr Career** - async –ø–∞—Ä—Å–µ—Ä (—Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è)
- ‚úÖ **GetMatch** - sync –ø–∞—Ä—Å–µ—Ä (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- ‚úÖ **Geekjob** - sync –ø–∞—Ä—Å–µ—Ä (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)

### **4. –†–µ–∑—É–ª—å—Ç–∞—Ç:**

#### **üöÄ –£–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ coroutine** - –±–æ–ª—å—à–µ –Ω–µ—Ç –æ—à–∏–±–æ–∫ —Å `object of type 'coroutine' has no len()`
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è async –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –≤—Å–µ async –º–µ—Ç–æ–¥—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ await'—è—Ç—Å—è
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** - –ø–∞—Ä—Å–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ asyncio
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ sync –ø–∞—Ä—Å–µ—Ä—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

#### **üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥** - –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–∞—Ä—Å—è—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **Async –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å async –ø–∞—Ä—Å–µ—Ä–∞–º–∏
- **–ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫** - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –±–µ–∑ coroutine –æ—à–∏–±–æ–∫

## üöÄ **–°—Ç–∞—Ç—É—Å: –ò–°–ü–†–ê–í–õ–ï–ù–û**

**–û—à–∏–±–∫–∞ coroutine –≤ –ø–∞—Ä—Å–µ—Ä–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞!**

- ‚úÖ **Async/await –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ –≤—Å–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** - —á–µ—Ä–µ–∑ asyncio
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ sync –∏ async –ø–∞—Ä—Å–µ—Ä–æ–≤
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - –±–µ–∑ –æ—à–∏–±–æ–∫ coroutine

**–¢–µ–ø–µ—Ä—å –ø–∞—Ä—Å–µ—Ä –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫!** üéâ





